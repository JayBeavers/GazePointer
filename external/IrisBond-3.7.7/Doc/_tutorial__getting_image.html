<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Irisbond Duo API: Getting the image from the camera</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
<link rel="shortcut icon" href="Irisbond.ico" type="image/x-icon" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Irisbond Duo API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">notitle</a></li>  </ul>
</div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Getting the image from the camera </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="Tutorial_GettingImage_Intro"></a>
Introduction</h1>
<p>The API provides a series of callback functions that send the information with the gaze points, calibration targets or click events. Each callback is optional, that is, there is no need to set a function that won't be used.</p>
<p>For each callback defined in the API, the usage is the same in all cases:</p><ul>
<li>Define the callback function to be executed from the API, following the callback declarations in the documentation.</li>
<li>Assign the callback function to a callback variable (in C#).</li>
<li>Set the callback to the API.</li>
</ul>
<p>In this tutorial, you will be setting some callbacks. These callbacks are reset each time the Start() function of the API is called. Please, set all callbacks each time and after the Start() function is called.</p>
<h1><a class="anchor" id="Tutorial_GettingImage_Gaze"></a>
Get the image from the eye tracker</h1>
<h2><a class="anchor" id="Tutorial_GettingImage_Gaze1"></a>
Define the callback function</h2>
<p>Following the steps defined in the previous section, the first step is to define the callback function to be executed from the API. In this case, the function must match the <a class="el" href="namespace_irisbond_a_p_i.html#ad2a0f2a548ce9c8561b3f93634038a37" title="Function to be called during the calibration when a new frame is acquired from the camera and the ima...">IrisbondAPI::IMAGE_CALLBACK</a> definition.</p>
<p>This function can be similiar to the following one (Invoke is omitted for simplicity): </p><div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> fun_imageCallback(IntPtr data, <span class="keywordtype">int</span> rows, <span class="keywordtype">int</span> cols, <span class="keywordtype">int</span> channels, <span class="keywordtype">long</span> timestamp)</div><div class="line">{</div><div class="line">    Image myImage = <span class="keyword">new</span> Bitmap(cols, rows, channels * cols, PixelFormat.Format8bppIndexed, data);</div><div class="line"></div><div class="line">    <span class="comment">// In WidowsForms the default palette is not grayscale, so let&#39;s change it</span></div><div class="line">    ColorPalette pal = myImage.Palette;</div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= 255; i++)</div><div class="line">        pal.Entries[i] = Color.FromArgb(i, i, i);</div><div class="line">    myImage.Palette = pal;</div><div class="line"></div><div class="line">    myPictureBox.Image = (Bitmap)myImage.Clone();</div><div class="line">}</div></div><!-- fragment --><h2><a class="anchor" id="Tutorial_GettingImage_Gaze2"></a>
Assign the callback function</h2>
<p>The second step is to assign the callback function to a callback variable. This is recommended in languages like C# where the garbage collector may destroy the reference to the callback function. In C++ this step is not required.</p>
<div class="fragment"><div class="line">IrisbondDuo.IMAGE_CALLBACK imageCallback = <span class="keyword">new</span> IrisbondDuo.IMAGE_CALLBACK(fun_imageCallback);</div></div><!-- fragment --><h2><a class="anchor" id="Tutorial_GettingImage_Gaze3"></a>
Set the callback to the API</h2>
<p>The final step is to set the callback to the API. In C++, the pointer to the function can be set, without the risk of being deleted by the garbage collector (there isn't).</p>
<div class="fragment"><div class="line">IrisbondDuo.setImageCallback(imageCallback);</div></div><!-- fragment --><p><b>Important:</b> the callbacks from the API are executed in the main thread, so the callback functions must not block the execution of the program. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.14-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
